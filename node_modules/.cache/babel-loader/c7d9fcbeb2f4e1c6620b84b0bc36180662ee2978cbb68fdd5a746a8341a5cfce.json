{"ast":null,"code":"import _regeneratorRuntime from\"/Users/kechitsonia/Desktop/OCR/DEV_FRONT/PROJET 12/SportSee-Front/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/Users/kechitsonia/Desktop/OCR/DEV_FRONT/PROJET 12/SportSee-Front/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/Users/kechitsonia/Desktop/OCR/DEV_FRONT/PROJET 12/SportSee-Front/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useState,useEffect}from\"react\";import{useParams,useNavigate}from\"react-router-dom\";import Header from\"../components/Header\";import KpiCards from\"../components/KpiCards\";import ActivityGraph from\"../components/ActivityGraph\";import AverageSessionsGraph from\"../components/AverageSessionsGraph\";import PerformanceGraph from\"../components/PerformanceGraph\";import UserScore from\"../components/UserScore\";import{getUser,getActivity,getAverageSessions,getPerformance}from\"../services/api\";import\"../styles/main.css\";import\"../styles/dashboard.css\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var Dashboard=function Dashboard(){// id de l'utilisateur récupéré\nvar _useParams=useParams(),id=_useParams.id;// retourne un objet / id est toujours une chaîne de caractères, même si c’est un nombre.\n// on redirige l'utilisateur si besoin\nvar navigate=useNavigate();// on stocks les données utilisateur\nvar _useState=useState(null),_useState2=_slicedToArray(_useState,2),userData=_useState2[0],setUserData=_useState2[1];var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),activityData=_useState4[0],setActivityData=_useState4[1];var _useState5=useState([]),_useState6=_slicedToArray(_useState5,2),sessionsData=_useState6[0],setSessionsData=_useState6[1];var _useState7=useState(null),_useState8=_slicedToArray(_useState7,2),performanceData=_useState8[0],setPerformanceData=_useState8[1];// Redirection si id absent\nuseEffect(function(){// Le hook se relance uniquement si l’ID change\n// sécurité, si url /user/undefined ou /user/ = renvoie accueil\nif(!id)navigate(\"/\");},[id,navigate]);// Récupération données\n// idem, si id n'existe pas on arrête (evite appels API inutiles)\nuseEffect(function(){if(!id)return;// appel API\nvar fetchData=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var _activity$data,_sessions$data,user,activity,sessions,performance;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return getUser(id);case 3:user=_context.sent;_context.next=6;return getActivity(id);case 6:activity=_context.sent;_context.next=9;return getAverageSessions(id);case 9:sessions=_context.sent;_context.next=12;return getPerformance(id);case 12:performance=_context.sent;// Mise à jour des states on stock les données\nsetUserData(user.data);// sécurité : si data n'existe pas on renvoit tableau vide\nsetActivityData(((_activity$data=activity.data)===null||_activity$data===void 0?void 0:_activity$data.sessions)||[]);setSessionsData(((_sessions$data=sessions.data)===null||_sessions$data===void 0?void 0:_sessions$data.sessions)||[]);setPerformanceData(performance.data||null);// erreur API\n_context.next=22;break;case 19:_context.prev=19;_context.t0=_context[\"catch\"](0);console.error(_context.t0);case 22:case\"end\":return _context.stop();}},_callee,null,[[0,19]]);}));return function fetchData(){return _ref.apply(this,arguments);};}();// on appelle fetchData, le useEffect se lance si id change\nfetchData();},[id]);// Sécurité\nif(!userData)return/*#__PURE__*/_jsx(\"div\",{children:\"Chargement...\"});return/*#__PURE__*/_jsx(\"div\",{className:\"dashboard\",children:/*#__PURE__*/_jsxs(\"main\",{className:\"main-dashboard\",children:[/*#__PURE__*/_jsx(Header,{user:userData}),/*#__PURE__*/_jsxs(\"div\",{className:\"dashboard-container\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"graphs-section\",children:[/*#__PURE__*/_jsx(ActivityGraph,{data:activityData}),/*#__PURE__*/_jsxs(\"div\",{className:\"graphs_display-flex\",children:[/*#__PURE__*/_jsx(AverageSessionsGraph,{data:sessionsData}),/*#__PURE__*/_jsx(PerformanceGraph,{data:performanceData}),/*#__PURE__*/_jsx(UserScore,{user:userData})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"kpi-section\",children:/*#__PURE__*/_jsx(KpiCards,{data:userData.keyData})})]})]})});};export default Dashboard;","map":{"version":3,"names":["React","useState","useEffect","useParams","useNavigate","Header","KpiCards","ActivityGraph","AverageSessionsGraph","PerformanceGraph","UserScore","getUser","getActivity","getAverageSessions","getPerformance","jsx","_jsx","jsxs","_jsxs","Dashboard","_useParams","id","navigate","_useState","_useState2","_slicedToArray","userData","setUserData","_useState3","_useState4","activityData","setActivityData","_useState5","_useState6","sessionsData","setSessionsData","_useState7","_useState8","performanceData","setPerformanceData","fetchData","_ref","_asyncToGenerator","_regeneratorRuntime","mark","_callee","_activity$data","_sessions$data","user","activity","sessions","performance","wrap","_callee$","_context","prev","next","sent","data","t0","console","error","stop","apply","arguments","children","className","keyData"],"sources":["/Users/kechitsonia/Desktop/OCR/DEV_FRONT/PROJET 12/SportSee-Front/src/pages/Dashboard.js"],"sourcesContent":["import React, { useState, useEffect } from \"react\";\nimport { useParams, useNavigate } from \"react-router-dom\";\nimport Header from \"../components/Header\";\nimport KpiCards from \"../components/KpiCards\";\nimport ActivityGraph from \"../components/ActivityGraph\";\nimport AverageSessionsGraph from \"../components/AverageSessionsGraph\";\nimport PerformanceGraph from \"../components/PerformanceGraph\";\nimport UserScore from \"../components/UserScore\";\nimport { getUser, getActivity, getAverageSessions, getPerformance } from \"../services/api\";\nimport \"../styles/main.css\";\nimport \"../styles/dashboard.css\";\n\n\nconst Dashboard = () => {\n  // id de l'utilisateur récupéré\n  const { id } = useParams(); // retourne un objet / id est toujours une chaîne de caractères, même si c’est un nombre.\n  // on redirige l'utilisateur si besoin\n  const navigate = useNavigate();\n  // on stocks les données utilisateur\n  const [userData, setUserData] = useState(null);\n  const [activityData, setActivityData] = useState([]);\n  const [sessionsData, setSessionsData] = useState([]);\n  const [performanceData, setPerformanceData] = useState(null);\n\n  // Redirection si id absent\n  useEffect(() => { // Le hook se relance uniquement si l’ID change\n    // sécurité, si url /user/undefined ou /user/ = renvoie accueil\n    if (!id) navigate(\"/\");\n  }, [id, navigate]);\n\n  // Récupération données\n  // idem, si id n'existe pas on arrête (evite appels API inutiles)\n  useEffect(() => {\n    if (!id) return;\n\n    // appel API\n    const fetchData = async () => {\n      try {\n        // Appelle /user/:id\n        const user = await getUser(id);\n        // Appelle /user/:id/activity\n        const activity = await getActivity(id);\n        const sessions = await getAverageSessions(id);\n        const performance = await getPerformance(id);\n\n        // Mise à jour des states on stock les données\n        setUserData(user.data);\n        // sécurité : si data n'existe pas on renvoit tableau vide\n        setActivityData(activity.data?.sessions || []);\n        setSessionsData(sessions.data?.sessions || []);\n        setPerformanceData(performance.data || null);\n        // erreur API\n      } catch (error) {\n        console.error(error);\n      }\n    };\n\n    // on appelle fetchData, le useEffect se lance si id change\n    fetchData();\n  }, [id]);\n\n  // Sécurité\n  if (!userData) return <div>Chargement...</div>;\n  return (\n    <div className=\"dashboard\">\n      <main className=\"main-dashboard\">\n        <Header user={userData}/>\n        <div className=\"dashboard-container\">\n          <div className=\"graphs-section\">\n            <ActivityGraph data={activityData}/>\n            <div className=\"graphs_display-flex\">\n              <AverageSessionsGraph data={sessionsData}/>\n              <PerformanceGraph data={performanceData}/>\n              <UserScore user={userData}/>\n            </div>\n          </div>\n          <div className=\"kpi-section\">\n            <KpiCards data={userData.keyData}/>\n          </div>\n        </div>\n      </main>\n    </div>\n  );\n};\nexport default Dashboard;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}